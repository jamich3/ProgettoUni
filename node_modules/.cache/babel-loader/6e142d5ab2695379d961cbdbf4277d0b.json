{"remainingRequest":"C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\src\\dataservice.js","dependencies":[{"path":"C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\src\\dataservice.js","mtime":1641839970466},{"path":"C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641768647009},{"path":"C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\node_modules\\babel-loader\\lib\\index.js","mtime":1641768664865},{"path":"C:\\Users\\Utente\\Documents\\Università_\\INFO2\\progettooo\\node_modules\\eslint-loader\\index.js","mtime":1641768650585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gIkBmaXJlYmFzZS9hcHAiOwppbXBvcnQgIkBmaXJlYmFzZS9maXJlc3RvcmUiOwpmaXJlYmFzZS5pbml0aWFsaXplQXBwKHsKICBhcGlLZXk6ICJBSXphU3lBZ2hZdnJpenVSN29CU0xNSzlBT1pscV83eWFfaGFZRlEiLAogIGF1dGhEb21haW46ICJpbmZvcm1hdGljYTItMzExNzMuZmlyZWJhc2VhcHAuY29tIiwKICBwcm9qZWN0SWQ6ICJ0ZXN0MS03NjU2OCIKfSk7CnZhciBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpOwpleHBvcnQgZGVmYXVsdCB7CiAgZ2V0UGVvcGxlOiBmdW5jdGlvbiAob2Zmc2V0KSB7CiAgICByZXR1cm4gYXhpb3MuZ2V0KCJodHRwczovL3N3YXBpLmRldi9hcGkvcGVvcGxlLz9vZmZzZXQ9IiArIChvZmZzZXQgfHwgMCkpOwogIH0sCiAgZ2V0UGVyc29uOiBmdW5jdGlvbiAobmFtZSkgewogICAgcmV0dXJuIGF4aW9zLmdldCgiaHR0cHM6Ly9zd2FwaS5kZXYvYXBpL3Blb3BsZS8iICsgbmFtZSk7CiAgfSwKICBzZWFyY2hQZXJzb246IGZ1bmN0aW9uICh0ZXJtKSB7CiAgICBpZiAoIXRlcm0gfHwgdGVybS5sZW5ndGggPCAzKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIGF4aW9zLmdldCgiaHR0cHM6Ly9zd2FwaS5kZXYvYXBpL3Blb3BsZS8/bGltaXQ9MTAwIikudGhlbihkYXRhID0+IHsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmRhdGEucmVzdWx0cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBwZXJzb24gPSBkYXRhLmRhdGEucmVzdWx0c1tpXTsKICAgICAgICB2YXIgbmFtZSA9IHBlcnNvbi5uYW1lOwoKICAgICAgICBpZiAobmFtZS5pbmRleE9mKHRlcm0pID49IDApIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKG5hbWUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgLyoNCiAgICAgIHJldHVybiBkYXRhLmRhdGEucmVzdWx0cw0KICAgICAgICAuZmlsdGVyKChwb2tlbW9uKSA9PiB7DQogICAgICAgICAgcmV0dXJuIHBva2Vtb24ubmFtZS5pbmRleE9mKHRlcm0pID49IDA7DQogICAgICAgIH0pDQogICAgICAgIC5tYXAoKHBva2Vtb24pID0+IHBva2Vtb24ubmFtZSk7DQogICAgICAgICovCiAgICB9KTsKICB9LAogIHZvdGU6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgcmV0dXJuIGRiLmNvbGxlY3Rpb24oInZvdGkiKS5kb2MoKS5zZXQoewogICAgICB2b3RvOiB2YWx1ZSwKICAgICAgcG9rZW1vbjogbmFtZSwKICAgICAgdXNlcm5hbWU6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VybmFtZSIpCiAgICB9KTsKICB9LAogIGdldFN0YXRzOiBmdW5jdGlvbiAobmFtZSkgewogICAgcmV0dXJuIGRiLmNvbGxlY3Rpb24oInZvdGkiKS53aGVyZSgicGVyc29uIiwgIj09IiwgbmFtZSkuZ2V0KCkudGhlbihkYXRhID0+IHsKICAgICAgbGV0IHN1bSA9IDA7CiAgICAgIGxldCB1c2VyVm90ZSA9IG51bGw7CiAgICAgIGxldCB1c2VybmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VybmFtZSIpOwogICAgICBkYXRhLmZvckVhY2goZG9jID0+IHsKICAgICAgICBzdW0gKz0gZG9jLmRhdGEoKS52b3RvOwoKICAgICAgICBpZiAoZG9jLmRhdGEoKS51c2VybmFtZSA9PT0gdXNlcm5hbWUpIHsKICAgICAgICAgIHVzZXJWb3RlID0gZG9jLmRhdGEoKS52b3RvOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG90YWxDb3VudDogZGF0YS5zaXplLAogICAgICAgIHVzZXJWb3RlOiB1c2VyVm90ZSwKICAgICAgICBhdmVyYWdlOiBkYXRhLnNpemUgPT09IDAgPyAwIDogc3VtIC8gZGF0YS5zaXplCiAgICAgIH07CiAgICB9KTsKICB9Cn07"},{"version":3,"sources":["C:/Users/Utente/Documents/Università_/INFO2/progettooo/src/dataservice.js"],"names":["axios","firebase","initializeApp","apiKey","authDomain","projectId","db","firestore","getPeople","offset","get","getPerson","name","searchPerson","term","length","Promise","resolve","then","data","result","i","results","person","indexOf","push","vote","value","collection","doc","set","voto","pokemon","username","localStorage","getItem","getStats","where","sum","userVote","forEach","totalCount","size","average"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,eAArB;AACA,OAAO,qBAAP;AAEAA,QAAQ,CAACC,aAAT,CAAuB;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,oCAFS;AAGrBC,EAAAA,SAAS,EAAE;AAHU,CAAvB;AAMA,IAAIC,EAAE,GAAGL,QAAQ,CAACM,SAAT,EAAT;AAEE,eAAe;AACbC,EAAAA,SAAS,EAAE,UAAUC,MAAV,EAAkB;AAC3B,WAAOT,KAAK,CAACU,GAAN,CAAU,2CAA4CD,MAAM,IAAI,CAAtD,CAAV,CAAP;AAED,GAJY;AAKbE,EAAAA,SAAS,EAAE,UAAUC,IAAV,EAAgB;AACzB,WAAOZ,KAAK,CAACU,GAAN,CAAU,kCAAkCE,IAA5C,CAAP;AACD,GAPY;AAQbC,EAAAA,YAAY,EAAE,UAAUC,IAAV,EAAgB;AAC9B,QAAI,CAACA,IAAD,IAASA,IAAI,CAACC,MAAL,GAAc,CAA3B,EAA8B;AAC5B,aAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;AAC9BA,QAAAA,OAAO,CAAC,EAAD,CAAP;AACD,OAFM,CAAP;AAGD;;AACD,WAAOjB,KAAK,CACTU,GADI,CACA,yCADA,EAEJQ,IAFI,CAEEC,IAAD,IAAU;AACd,UAAIC,MAAM,GAAG,EAAb;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACA,IAAL,CAAUG,OAAV,CAAkBP,MAAtC,EAA8CM,CAAC,EAA/C,EAAmD;AACjD,YAAIE,MAAM,GAAGJ,IAAI,CAACA,IAAL,CAAUG,OAAV,CAAkBD,CAAlB,CAAb;AACA,YAAIT,IAAI,GAAGW,MAAM,CAACX,IAAlB;;AACA,YAAIA,IAAI,CAACY,OAAL,CAAaV,IAAb,KAAsB,CAA1B,EAA6B;AAC3BM,UAAAA,MAAM,CAACK,IAAP,CAAYb,IAAZ;AACD;AACF;;AACD,aAAOQ,MAAP;AAEA;AACR;AACA;AACA;AACA;AACA;AACA;AACO,KApBI,CAAP;AAqBC,GAnCY;AAoCbM,EAAAA,IAAI,EAAE,UAAUd,IAAV,EAAgBe,KAAhB,EAAuB;AAC3B,WAAOrB,EAAE,CACNsB,UADI,CACO,MADP,EAEJC,GAFI,GAGJC,GAHI,CAGA;AACHC,MAAAA,IAAI,EAAEJ,KADH;AAEHK,MAAAA,OAAO,EAAEpB,IAFN;AAGHqB,MAAAA,QAAQ,EAAEC,YAAY,CAACC,OAAb,CAAqB,UAArB;AAHP,KAHA,CAAP;AAQD,GA7CY;AA8CbC,EAAAA,QAAQ,EAAE,UAAUxB,IAAV,EAAgB;AACxB,WAAON,EAAE,CACNsB,UADI,CACO,MADP,EAEJS,KAFI,CAEE,QAFF,EAEY,IAFZ,EAEkBzB,IAFlB,EAGJF,GAHI,GAIJQ,IAJI,CAIEC,IAAD,IAAU;AACd,UAAImB,GAAG,GAAG,CAAV;AACA,UAAIC,QAAQ,GAAG,IAAf;AACA,UAAIN,QAAQ,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAf;AACAhB,MAAAA,IAAI,CAACqB,OAAL,CAAcX,GAAD,IAAS;AACpBS,QAAAA,GAAG,IAAIT,GAAG,CAACV,IAAJ,GAAWY,IAAlB;;AACA,YAAIF,GAAG,CAACV,IAAJ,GAAWc,QAAX,KAAwBA,QAA5B,EAAsC;AACpCM,UAAAA,QAAQ,GAAGV,GAAG,CAACV,IAAJ,GAAWY,IAAtB;AACD;AACF,OALD;AAMA,aAAO;AACLU,QAAAA,UAAU,EAAEtB,IAAI,CAACuB,IADZ;AAELH,QAAAA,QAAQ,EAAEA,QAFL;AAGLI,QAAAA,OAAO,EAAExB,IAAI,CAACuB,IAAL,KAAc,CAAd,GAAkB,CAAlB,GAAsBJ,GAAG,GAAGnB,IAAI,CAACuB;AAHrC,OAAP;AAKD,KAnBI,CAAP;AAoBH;AAnEc,CAAf","sourcesContent":["import axios from \"axios\";\r\nimport firebase from \"@firebase/app\";\r\nimport \"@firebase/firestore\";\r\n\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyAghYvrizuR7oBSLMK9AOZlq_7ya_haYFQ\",\r\n  authDomain: \"informatica2-31173.firebaseapp.com\",\r\n  projectId: \"test1-76568\"\r\n});\r\n\r\nvar db = firebase.firestore();\r\n\r\n  export default {\r\n    getPeople: function (offset) {\r\n      return axios.get(\"https://swapi.dev/api/people/?offset=\"  + (offset || 0)\r\n      );\r\n    },\r\n    getPerson: function (name) {\r\n      return axios.get(\"https://swapi.dev/api/people/\" + name);\r\n    },\r\n    searchPerson: function (term) {\r\n    if (!term || term.length < 3) {\r\n      return new Promise((resolve) => {\r\n        resolve([]);\r\n      });\r\n    }\r\n    return axios\r\n      .get(\"https://swapi.dev/api/people/?limit=100\")\r\n      .then((data) => {\r\n        var result = [];\r\n        for (var i = 0; i < data.data.results.length; i++) {\r\n          var person = data.data.results[i];\r\n          var name = person.name;\r\n          if (name.indexOf(term) >= 0) {\r\n            result.push(name);\r\n          }\r\n        }\r\n        return result;\r\n\r\n        /*\r\n        return data.data.results\r\n          .filter((pokemon) => {\r\n            return pokemon.name.indexOf(term) >= 0;\r\n          })\r\n          .map((pokemon) => pokemon.name);\r\n          */\r\n      });\r\n    },\r\n    vote: function (name, value) {\r\n      return db\r\n        .collection(\"voti\")\r\n        .doc()\r\n        .set({\r\n          voto: value,\r\n          pokemon: name,\r\n          username: localStorage.getItem(\"username\")\r\n        });\r\n    },\r\n    getStats: function (name) {\r\n      return db\r\n        .collection(\"voti\")\r\n        .where(\"person\", \"==\", name)\r\n        .get()\r\n        .then((data) => {\r\n          let sum = 0;\r\n          let userVote = null;\r\n          let username = localStorage.getItem(\"username\");\r\n          data.forEach((doc) => {\r\n            sum += doc.data().voto;\r\n            if (doc.data().username === username) {\r\n              userVote = doc.data().voto;\r\n            }\r\n          });\r\n          return {\r\n            totalCount: data.size,\r\n            userVote: userVote,\r\n            average: data.size === 0 ? 0 : sum / data.size\r\n          };\r\n        });\r\n  },\r\n}\r\n\r\n"]}]}