{"remainingRequest":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\src\\dataservice.js","dependencies":[{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\src\\dataservice.js","mtime":1643116617396},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641768647009},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\babel-loader\\lib\\index.js","mtime":1641768664865},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\eslint-loader\\index.js","mtime":1641768650585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gIkBmaXJlYmFzZS9hcHAiOwppbXBvcnQgIkBmaXJlYmFzZS9maXJlc3RvcmUiOyAvLyBGaXJlYmFzZQoKZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcCh7CiAgYXBpS2V5OiAiQUl6YVN5Q1lYREstOGZEZEE1UEZtUEoyTGFJYUlzU0J0VXY1bXFvIiwKICBhdXRoRG9tYWluOiAic3dwcm9qZWN0LTY1NTY2LmZpcmViYXNlYXBwLmNvbSIsCiAgcHJvamVjdElkOiAic3dwcm9qZWN0LTY1NTY2IiwKICBzdG9yYWdlQnVja2V0OiAic3dwcm9qZWN0LTY1NTY2LmFwcHNwb3QuY29tIiwKICBtZXNzYWdpbmdTZW5kZXJJZDogIjMzNzE1MDQ5NDkzMCIsCiAgYXBwSWQ6ICIxOjMzNzE1MDQ5NDkzMDp3ZWI6OTk4M2NjMjU2YmE5MmY0Y2Y4MDUwYiIsCiAgbWVhc3VyZW1lbnRJZDogIkctSFRFOEowVzBYNyIKfSk7CnZhciBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpOwpleHBvcnQgZGVmYXVsdCB7CiAgLy9Mb2dpbgogIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuICEhbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJuYW1lIik7CiAgfSwKICBsb2dpbjogZnVuY3Rpb24gKHVzZXJuYW1lKSB7CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlcm5hbWUiLCB1c2VybmFtZSk7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uICgpIHsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VybmFtZSIpOwogIH0sCiAgLy8gTGlzdGEgZGkgcGVyc29uYWdnaSBpbiBiYXNlIGFsbGEgcGFnaW5hCiAgZ2V0UGVvcGxlOiBmdW5jdGlvbiAocGFnZSkgewogICAgcmV0dXJuIGF4aW9zLmdldCgiaHR0cHM6Ly9zd2FwaS5kZXYvYXBpL3Blb3BsZS8/cGFnZT0iICsgcGFnZSk7CiAgfSwKICAvLyBQZXIgb3R0ZW5lcmUgaW5mb3JtYXppb25pIGRlbCBwZXJzb25hZ2dpbyBpbiBEZXRhaWwKICBnZXRQZXJzb246IGZ1bmN0aW9uIChpZCkgewogICAgcmV0dXJuIGF4aW9zLmdldCgiaHR0cHM6Ly9zd2FwaS5kZXYvYXBpL3Blb3BsZS8iICsgaWQgKyAiLyIpOwogIH0sCiAgLy9SYXRpbmcgc3RhcnMgcGVyIHBlcnNvbmFnZ2kKICB2b3RlOiBmdW5jdGlvbiAoaWQsIHZhbHVlKSB7CiAgICByZXR1cm4gZGIuY29sbGVjdGlvbigidm90aSIpLmRvYygpLnNldCh7CiAgICAgIHZvdG86IHZhbHVlLAogICAgICBpZF9wZXJzb246IGlkLAogICAgICB1c2VybmFtZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJuYW1lIikKICAgIH0pOwogIH0sCiAgZ2V0U3RhdHM6IGZ1bmN0aW9uIChpZCkgewogICAgcmV0dXJuIGRiLmNvbGxlY3Rpb24oInZvdGkiKS53aGVyZSgiaWRfcGVyc29uIiwgIj09IiwgaWQpLmdldCgpLnRoZW4oZGF0YSA9PiB7CiAgICAgIGxldCBzdW0gPSAwOwogICAgICBsZXQgdXNlclZvdGUgPSBudWxsOwogICAgICBsZXQgdXNlcm5hbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcm5hbWUiKTsKICAgICAgZGF0YS5mb3JFYWNoKGRvYyA9PiB7CiAgICAgICAgc3VtICs9IGRvYy5kYXRhKCkudm90bzsKCiAgICAgICAgaWYgKGRvYy5kYXRhKCkudXNlcm5hbWUgPT09IHVzZXJuYW1lKSB7CiAgICAgICAgICB1c2VyVm90ZSA9IGRvYy5kYXRhKCkudm90bzsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIHRvdGFsQ291bnQ6IGRhdGEuc2l6ZSwKICAgICAgICB1c2VyVm90ZTogdXNlclZvdGUsCiAgICAgICAgYXZlcmFnZTogZGF0YS5zaXplID09PSAwID8gMCA6IHN1bSAvIGRhdGEuc2l6ZQogICAgICB9OwogICAgfSk7CiAgfQp9Ow=="},{"version":3,"sources":["C:/Users/Utente/Documents/Università/INFO2/ProgettoInfo2/src/dataservice.js"],"names":["axios","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","firestore","isAuthenticated","localStorage","getItem","login","username","setItem","logout","removeItem","getPeople","page","get","getPerson","id","vote","value","collection","doc","set","voto","id_person","getStats","where","then","data","sum","userVote","forEach","totalCount","size","average"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,eAArB;AACA,OAAO,qBAAP,C,CAEA;;AACAA,QAAQ,CAACC,aAAT,CAAuB;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,iCAFS;AAGrBC,EAAAA,SAAS,EAAE,iBAHU;AAIrBC,EAAAA,aAAa,EAAE,6BAJM;AAKrBC,EAAAA,iBAAiB,EAAE,cALE;AAMrBC,EAAAA,KAAK,EAAE,2CANc;AAOrBC,EAAAA,aAAa,EAAE;AAPM,CAAvB;AAUA,IAAIC,EAAE,GAAGT,QAAQ,CAACU,SAAT,EAAT;AAEA,eAAe;AACb;AACAC,EAAAA,eAAe,EAAE,YAAY;AAC3B,WAAO,CAAC,CAACC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAT;AACD,GAJY;AAKbC,EAAAA,KAAK,EAAE,UAAUC,QAAV,EAAoB;AACzBH,IAAAA,YAAY,CAACI,OAAb,CAAqB,UAArB,EAAiCD,QAAjC;AACD,GAPY;AAQbE,EAAAA,MAAM,EAAE,YAAY;AAClBL,IAAAA,YAAY,CAACM,UAAb,CAAwB,UAAxB;AACD,GAVY;AAWb;AACAC,EAAAA,SAAS,EAAE,UAAUC,IAAV,EAAgB;AACzB,WAAOrB,KAAK,CAACsB,GAAN,CAAU,wCAAwCD,IAAlD,CAAP;AACD,GAdY;AAeb;AACAE,EAAAA,SAAS,EAAE,UAAUC,EAAV,EAAc;AACvB,WAAOxB,KAAK,CAACsB,GAAN,CAAU,kCAAkCE,EAAlC,GAAuC,GAAjD,CAAP;AACD,GAlBY;AAmBb;AACAC,EAAAA,IAAI,EAAE,UAAUD,EAAV,EAAcE,KAAd,EAAqB;AACzB,WAAOhB,EAAE,CACNiB,UADI,CACO,MADP,EAEJC,GAFI,GAGJC,GAHI,CAGA;AACHC,MAAAA,IAAI,EAAEJ,KADH;AAEHK,MAAAA,SAAS,EAAEP,EAFR;AAGHR,MAAAA,QAAQ,EAAEH,YAAY,CAACC,OAAb,CAAqB,UAArB;AAHP,KAHA,CAAP;AAQD,GA7BY;AA8BbkB,EAAAA,QAAQ,EAAE,UAAUR,EAAV,EAAc;AACtB,WAAOd,EAAE,CACNiB,UADI,CACO,MADP,EAEJM,KAFI,CAEE,WAFF,EAEe,IAFf,EAEqBT,EAFrB,EAGJF,GAHI,GAIJY,IAJI,CAIEC,IAAD,IAAU;AACd,UAAIC,GAAG,GAAG,CAAV;AACA,UAAIC,QAAQ,GAAG,IAAf;AACA,UAAIrB,QAAQ,GAAGH,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAf;AACAqB,MAAAA,IAAI,CAACG,OAAL,CAAcV,GAAD,IAAS;AACpBQ,QAAAA,GAAG,IAAIR,GAAG,CAACO,IAAJ,GAAWL,IAAlB;;AACA,YAAIF,GAAG,CAACO,IAAJ,GAAWnB,QAAX,KAAwBA,QAA5B,EAAsC;AACpCqB,UAAAA,QAAQ,GAAGT,GAAG,CAACO,IAAJ,GAAWL,IAAtB;AACD;AACF,OALD;AAMA,aAAO;AACLS,QAAAA,UAAU,EAAEJ,IAAI,CAACK,IADZ;AAELH,QAAAA,QAAQ,EAAEA,QAFL;AAGLI,QAAAA,OAAO,EAAEN,IAAI,CAACK,IAAL,KAAc,CAAd,GAAkB,CAAlB,GAAsBJ,GAAG,GAAGD,IAAI,CAACK;AAHrC,OAAP;AAKD,KAnBI,CAAP;AAoBD;AAnDY,CAAf","sourcesContent":["import axios from \"axios\";\r\nimport firebase from \"@firebase/app\";\r\nimport \"@firebase/firestore\";\r\n\r\n// Firebase\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyCYXDK-8fDdA5PFmPJ2LaIaIsSBtUv5mqo\",\r\n  authDomain: \"swproject-65566.firebaseapp.com\",\r\n  projectId: \"swproject-65566\",\r\n  storageBucket: \"swproject-65566.appspot.com\",\r\n  messagingSenderId: \"337150494930\",\r\n  appId: \"1:337150494930:web:9983cc256ba92f4cf8050b\",\r\n  measurementId: \"G-HTE8J0W0X7\"\r\n});\r\n\r\nvar db = firebase.firestore();\r\n\r\nexport default {\r\n  //Login\r\n  isAuthenticated: function () {\r\n    return !!localStorage.getItem(\"username\");\r\n  },\r\n  login: function (username) {\r\n    localStorage.setItem(\"username\", username);\r\n  },\r\n  logout: function () {\r\n    localStorage.removeItem(\"username\");\r\n  },\r\n  // Lista di personaggi in base alla pagina\r\n  getPeople: function (page) {\r\n    return axios.get(\"https://swapi.dev/api/people/?page=\" + page);\r\n  },\r\n  // Per ottenere informazioni del personaggio in Detail\r\n  getPerson: function (id) {\r\n    return axios.get(\"https://swapi.dev/api/people/\" + id + \"/\");\r\n  },\r\n  //Rating stars per personaggi\r\n  vote: function (id, value) {\r\n    return db\r\n      .collection(\"voti\")\r\n      .doc()\r\n      .set({\r\n        voto: value,\r\n        id_person: id,\r\n        username: localStorage.getItem(\"username\")\r\n      });\r\n  },\r\n  getStats: function (id) {\r\n    return db\r\n      .collection(\"voti\")\r\n      .where(\"id_person\", \"==\", id)\r\n      .get()\r\n      .then((data) => {\r\n        let sum = 0;\r\n        let userVote = null;\r\n        let username = localStorage.getItem(\"username\");\r\n        data.forEach((doc) => {\r\n          sum += doc.data().voto;\r\n          if (doc.data().username === username) {\r\n            userVote = doc.data().voto;\r\n          }\r\n        });\r\n        return {\r\n          totalCount: data.size,\r\n          userVote: userVote,\r\n          average: data.size === 0 ? 0 : sum / data.size\r\n        };\r\n      });\r\n  }\r\n};\r\n\r\n"]}]}