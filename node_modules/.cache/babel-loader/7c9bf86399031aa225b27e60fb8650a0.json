{"remainingRequest":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\src\\dataservice.js","dependencies":[{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\src\\dataservice.js","mtime":1643116551828},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641768647009},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\babel-loader\\lib\\index.js","mtime":1641768664865},{"path":"C:\\Users\\Utente\\Documents\\Università\\INFO2\\ProgettoInfo2\\node_modules\\eslint-loader\\index.js","mtime":1641768650585}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gIkBmaXJlYmFzZS9hcHAiOwppbXBvcnQgIkBmaXJlYmFzZS9maXJlc3RvcmUiOyAvLyBGaXJlYmFzZSBhbmNvcmEgbm9uIHV0aWxpenphdG8KCmZpcmViYXNlLmluaXRpYWxpemVBcHAoewogIGFwaUtleTogIkFJemFTeUNZWERLLThmRGRBNVBGbVBKMkxhSWFJc1NCdFV2NW1xbyIsCiAgYXV0aERvbWFpbjogInN3cHJvamVjdC02NTU2Ni5maXJlYmFzZWFwcC5jb20iLAogIHByb2plY3RJZDogInN3cHJvamVjdC02NTU2NiIsCiAgc3RvcmFnZUJ1Y2tldDogInN3cHJvamVjdC02NTU2Ni5hcHBzcG90LmNvbSIsCiAgbWVzc2FnaW5nU2VuZGVySWQ6ICIzMzcxNTA0OTQ5MzAiLAogIGFwcElkOiAiMTozMzcxNTA0OTQ5MzA6d2ViOjk5ODNjYzI1NmJhOTJmNGNmODA1MGIiLAogIG1lYXN1cmVtZW50SWQ6ICJHLUhURThKMFcwWDciCn0pOwp2YXIgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTsKZXhwb3J0IGRlZmF1bHQgewogIC8vTG9naW4gdGhpbmdzIC0tLS0tLS0tLS0tLQogIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24gKCkgewogICAgcmV0dXJuICEhbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJuYW1lIik7CiAgfSwKICBsb2dpbjogZnVuY3Rpb24gKHVzZXJuYW1lKSB7CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlcm5hbWUiLCB1c2VybmFtZSk7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uICgpIHsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VybmFtZSIpOwogIH0sCiAgLy8gTm9uIG1pIGxlZ2dlIGlsIHB2YWx1ZSAtLT4gaW4gTElTVCwgbmVsbGEgcGFnaW5hemlvbmUKICBnZXRQZW9wbGU6IGZ1bmN0aW9uIChwYWdlKSB7CiAgICByZXR1cm4gYXhpb3MuZ2V0KCJodHRwczovL3N3YXBpLmRldi9hcGkvcGVvcGxlLz9wYWdlPSIgKyBwYWdlKTsKICB9LAogIC8vIFFVRVNUTyBGVU5aSU9OQQogIGdldFBlcnNvbjogZnVuY3Rpb24gKGlkKSB7CiAgICByZXR1cm4gYXhpb3MuZ2V0KCJodHRwczovL3N3YXBpLmRldi9hcGkvcGVvcGxlLyIgKyBpZCArICIvIik7CiAgfSwKICAvL1JhdGluZyBzdGFycyBwZXIgcGVyc29uYWdnaQogIHZvdGU6IGZ1bmN0aW9uIChpZCwgdmFsdWUpIHsKICAgIHJldHVybiBkYi5jb2xsZWN0aW9uKCJ2b3RpIikuZG9jKCkuc2V0KHsKICAgICAgdm90bzogdmFsdWUsCiAgICAgIGlkX3BlcnNvbjogaWQsCiAgICAgIHVzZXJuYW1lOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcm5hbWUiKQogICAgfSk7CiAgfSwKICBnZXRTdGF0czogZnVuY3Rpb24gKGlkKSB7CiAgICByZXR1cm4gZGIuY29sbGVjdGlvbigidm90aSIpLndoZXJlKCJpZF9wZXJzb24iLCAiPT0iLCBpZCkuZ2V0KCkudGhlbihkYXRhID0+IHsKICAgICAgbGV0IHN1bSA9IDA7CiAgICAgIGxldCB1c2VyVm90ZSA9IG51bGw7CiAgICAgIGxldCB1c2VybmFtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VybmFtZSIpOwogICAgICBkYXRhLmZvckVhY2goZG9jID0+IHsKICAgICAgICBzdW0gKz0gZG9jLmRhdGEoKS52b3RvOwoKICAgICAgICBpZiAoZG9jLmRhdGEoKS51c2VybmFtZSA9PT0gdXNlcm5hbWUpIHsKICAgICAgICAgIHVzZXJWb3RlID0gZG9jLmRhdGEoKS52b3RvOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG90YWxDb3VudDogZGF0YS5zaXplLAogICAgICAgIHVzZXJWb3RlOiB1c2VyVm90ZSwKICAgICAgICBhdmVyYWdlOiBkYXRhLnNpemUgPT09IDAgPyAzIDogc3VtIC8gZGF0YS5zaXplCiAgICAgIH07CiAgICB9KTsKICB9Cn07"},{"version":3,"sources":["C:/Users/Utente/Documents/Università/INFO2/ProgettoInfo2/src/dataservice.js"],"names":["axios","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","firestore","isAuthenticated","localStorage","getItem","login","username","setItem","logout","removeItem","getPeople","page","get","getPerson","id","vote","value","collection","doc","set","voto","id_person","getStats","where","then","data","sum","userVote","forEach","totalCount","size","average"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,eAArB;AACA,OAAO,qBAAP,C,CAEA;;AACAA,QAAQ,CAACC,aAAT,CAAuB;AACrBC,EAAAA,MAAM,EAAE,yCADa;AAErBC,EAAAA,UAAU,EAAE,iCAFS;AAGrBC,EAAAA,SAAS,EAAE,iBAHU;AAIrBC,EAAAA,aAAa,EAAE,6BAJM;AAKrBC,EAAAA,iBAAiB,EAAE,cALE;AAMrBC,EAAAA,KAAK,EAAE,2CANc;AAOrBC,EAAAA,aAAa,EAAE;AAPM,CAAvB;AAUA,IAAIC,EAAE,GAAGT,QAAQ,CAACU,SAAT,EAAT;AAEA,eAAe;AACb;AACAC,EAAAA,eAAe,EAAE,YAAY;AAC3B,WAAO,CAAC,CAACC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAT;AACD,GAJY;AAKbC,EAAAA,KAAK,EAAE,UAAUC,QAAV,EAAoB;AACzBH,IAAAA,YAAY,CAACI,OAAb,CAAqB,UAArB,EAAiCD,QAAjC;AACD,GAPY;AAQbE,EAAAA,MAAM,EAAE,YAAY;AAClBL,IAAAA,YAAY,CAACM,UAAb,CAAwB,UAAxB;AACD,GAVY;AAWb;AACAC,EAAAA,SAAS,EAAE,UAAUC,IAAV,EAAgB;AACzB,WAAOrB,KAAK,CAACsB,GAAN,CAAU,wCAAwCD,IAAlD,CAAP;AACD,GAdY;AAeb;AACAE,EAAAA,SAAS,EAAE,UAAUC,EAAV,EAAc;AACvB,WAAOxB,KAAK,CAACsB,GAAN,CAAU,kCAAkCE,EAAlC,GAAuC,GAAjD,CAAP;AACD,GAlBY;AAmBb;AACAC,EAAAA,IAAI,EAAE,UAAUD,EAAV,EAAcE,KAAd,EAAqB;AACzB,WAAOhB,EAAE,CACNiB,UADI,CACO,MADP,EAEJC,GAFI,GAGJC,GAHI,CAGA;AACHC,MAAAA,IAAI,EAAEJ,KADH;AAEHK,MAAAA,SAAS,EAAEP,EAFR;AAGHR,MAAAA,QAAQ,EAAEH,YAAY,CAACC,OAAb,CAAqB,UAArB;AAHP,KAHA,CAAP;AAQD,GA7BY;AA8BbkB,EAAAA,QAAQ,EAAE,UAAUR,EAAV,EAAc;AACtB,WAAOd,EAAE,CACNiB,UADI,CACO,MADP,EAEJM,KAFI,CAEE,WAFF,EAEe,IAFf,EAEqBT,EAFrB,EAGJF,GAHI,GAIJY,IAJI,CAIEC,IAAD,IAAU;AACd,UAAIC,GAAG,GAAG,CAAV;AACA,UAAIC,QAAQ,GAAG,IAAf;AACA,UAAIrB,QAAQ,GAAGH,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAf;AACAqB,MAAAA,IAAI,CAACG,OAAL,CAAcV,GAAD,IAAS;AACpBQ,QAAAA,GAAG,IAAIR,GAAG,CAACO,IAAJ,GAAWL,IAAlB;;AACA,YAAIF,GAAG,CAACO,IAAJ,GAAWnB,QAAX,KAAwBA,QAA5B,EAAsC;AACpCqB,UAAAA,QAAQ,GAAGT,GAAG,CAACO,IAAJ,GAAWL,IAAtB;AACD;AACF,OALD;AAMA,aAAO;AACLS,QAAAA,UAAU,EAAEJ,IAAI,CAACK,IADZ;AAELH,QAAAA,QAAQ,EAAEA,QAFL;AAGLI,QAAAA,OAAO,EAAEN,IAAI,CAACK,IAAL,KAAc,CAAd,GAAkB,CAAlB,GAAsBJ,GAAG,GAAGD,IAAI,CAACK;AAHrC,OAAP;AAKD,KAnBI,CAAP;AAoBD;AAnDY,CAAf","sourcesContent":["import axios from \"axios\";\r\nimport firebase from \"@firebase/app\";\r\nimport \"@firebase/firestore\";\r\n\r\n// Firebase ancora non utilizzato\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyCYXDK-8fDdA5PFmPJ2LaIaIsSBtUv5mqo\",\r\n  authDomain: \"swproject-65566.firebaseapp.com\",\r\n  projectId: \"swproject-65566\",\r\n  storageBucket: \"swproject-65566.appspot.com\",\r\n  messagingSenderId: \"337150494930\",\r\n  appId: \"1:337150494930:web:9983cc256ba92f4cf8050b\",\r\n  measurementId: \"G-HTE8J0W0X7\"\r\n});\r\n\r\nvar db = firebase.firestore();\r\n\r\nexport default {\r\n  //Login things ------------\r\n  isAuthenticated: function () {\r\n    return !!localStorage.getItem(\"username\");\r\n  },\r\n  login: function (username) {\r\n    localStorage.setItem(\"username\", username);\r\n  },\r\n  logout: function () {\r\n    localStorage.removeItem(\"username\");\r\n  },\r\n  // Non mi legge il pvalue --> in LIST, nella paginazione\r\n  getPeople: function (page) {\r\n    return axios.get(\"https://swapi.dev/api/people/?page=\" + page);\r\n  },\r\n  // QUESTO FUNZIONA\r\n  getPerson: function (id) {\r\n    return axios.get(\"https://swapi.dev/api/people/\" + id + \"/\");\r\n  },\r\n  //Rating stars per personaggi\r\n  vote: function (id, value) {\r\n    return db\r\n      .collection(\"voti\")\r\n      .doc()\r\n      .set({\r\n        voto: value,\r\n        id_person: id,\r\n        username: localStorage.getItem(\"username\")\r\n      });\r\n  },\r\n  getStats: function (id) {\r\n    return db\r\n      .collection(\"voti\")\r\n      .where(\"id_person\", \"==\", id)\r\n      .get()\r\n      .then((data) => {\r\n        let sum = 0;\r\n        let userVote = null;\r\n        let username = localStorage.getItem(\"username\");\r\n        data.forEach((doc) => {\r\n          sum += doc.data().voto;\r\n          if (doc.data().username === username) {\r\n            userVote = doc.data().voto;\r\n          }\r\n        });\r\n        return {\r\n          totalCount: data.size,\r\n          userVote: userVote,\r\n          average: data.size === 0 ? 3 : sum / data.size\r\n        };\r\n      });\r\n  }\r\n};\r\n\r\n"]}]}